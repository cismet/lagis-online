import React, { useState } from 'react';
import { Map } from 'react-leaflet';
import { getLayersByName, MappingConstants, FeatureCollectionDisplay } from 'react-cismap';
import Color from 'color';
import useWindowSize from '@rehooks/window-size';

const LagisMap = ({ size: predefinedHeight }) => {
	const mockFC = [
		{
			id: 1,
			index: 0,
			text: 'Elberfeld 335 48/0',
			type: 'Feature',
			selected: true,
			geometry: {
				type: 'MultiPolygon',
				coordinates: [
					[
						[
							[ 370335.032999999995809, 5679705.768000000156462 ],
							[ 370337.508000001020264, 5679699.802000000141561 ],
							[ 370343.506999998993706, 5679685.339999999850988 ],
							[ 370359.699999999022111, 5679691.798000000417233 ],
							[ 370371.223999998997897, 5679696.40500000026077 ],
							[ 370399.96999999898253, 5679707.904000000096858 ],
							[ 370403.543999999994412, 5679709.332999999634922 ],
							[ 370407.368999999016523, 5679710.946999999694526 ],
							[ 370407.484000000986271, 5679710.658999999985099 ],
							[ 370408.870000000984874, 5679707.178999999538064 ],
							[ 370427.884000000020023, 5679659.275000000372529 ],
							[ 370431.583000000973698, 5679649.951999999582767 ],
							[ 370432.464000002015382, 5679647.730000000447035 ],
							[ 370441.186999998986721, 5679625.69400000013411 ],
							[ 370451.359000000986271, 5679599.998999999836087 ],
							[ 370454.271999999997206, 5679592.638000000268221 ],
							[ 370450.208000000973698, 5679586.310999999754131 ],
							[ 370444.550000000977889, 5679579.497999999672174 ],
							[ 370433.894000001018867, 5679572.406000000424683 ],
							[ 370424.793999999994412, 5679567.674999999813735 ],
							[ 370415.811000000976492, 5679563.339999999850988 ],
							[ 370406.449000001011882, 5679559.519999999552965 ],
							[ 370397.160999997984618, 5679556.298000000417233 ],
							[ 370387.50199999997858, 5679553.791000000201166 ],
							[ 370382.554999999993015, 5679539.253999999724329 ],
							[ 370382.545999999972992, 5679539.224999999627471 ],
							[ 370382.498999997973442, 5679539.087000000290573 ],
							[ 370376.559999999008141, 5679534.927000000141561 ],
							[ 370372.822000000975095, 5679532.308000000193715 ],
							[ 370362.929999999993015, 5679525.377999999560416 ],
							[ 370361.149999998975545, 5679523.449000000022352 ],
							[ 370305.509999997972045, 5679483.893000000156462 ],
							[ 370300.896999999997206, 5679481.178999999538064 ],
							[ 370296.623999997973442, 5679479.45299999974668 ],
							[ 370295.986168533971068, 5679479.246529960073531 ],
							[ 370295.332441134029068, 5679479.097871500067413 ],
							[ 370294.668046434002463, 5679479.008213610388339 ],
							[ 370293.998298394028097, 5679478.978273400105536 ],
							[ 370293.328553789004218, 5679479.008290340192616 ],
							[ 370292.664169365016278, 5679479.098024340346456 ],
							[ 370292.010458999022376, 5679479.246757689863443 ],
							[ 370291.372651193989441, 5679479.453300800174475 ],
							[ 370290.755847259017173, 5679479.7160016996786 ],
							[ 370290.164980513975024, 5679480.032759239897132 ],
							[ 370289.604776824999135, 5679480.40103994961828 ],
							[ 370289.079716810025275, 5679480.817898239940405 ],
							[ 370288.594000000972301, 5679481.28000000026077 ],
							[ 370274.156999998027459, 5679500.075000000186265 ],
							[ 370273.881000000983477, 5679500.331000000238419 ],
							[ 370270.467000000004191, 5679503.502999999560416 ],
							[ 370268.854999999981374, 5679504.993999999947846 ],
							[ 370268.090999997977633, 5679505.458999999798834 ],
							[ 370264.265999999013729, 5679507.782999999821186 ],
							[ 370260.428999998024665, 5679511.842000000178814 ],
							[ 370256.925000000977889, 5679516.686999999918044 ],
							[ 370252.806000002019573, 5679523.660000000149012 ],
							[ 370251.686999998986721, 5679523.205000000074506 ],
							[ 370245.026000001002103, 5679535.90500000026077 ],
							[ 370241.752999998978339, 5679542.145999999716878 ],
							[ 370240.824000001011882, 5679543.916000000201166 ],
							[ 370240.601000000024214, 5679544.341000000014901 ],
							[ 370299.197000000975095, 5679574.783999999985099 ],
							[ 370298.826999999990221, 5679575.501000000163913 ],
							[ 370300.651999999012332, 5679576.440999999642372 ],
							[ 370297.484000000986271, 5679582.593999999575317 ],
							[ 370304.048999999009538, 5679585.987999999895692 ],
							[ 370303.03000000101747, 5679587.993999999947846 ],
							[ 370303.289000000979286, 5679588.127000000327826 ],
							[ 370333.756000000983477, 5679603.81900000013411 ],
							[ 370344.465999997977633, 5679609.331000000238419 ],
							[ 370346.376000002026558, 5679610.315000000409782 ],
							[ 370344.178999998024665, 5679614.583999999798834 ],
							[ 370357.247000001021661, 5679619.995000000111759 ],
							[ 370357.193999997980427, 5679620.128999999724329 ],
							[ 370345.175999998988118, 5679649.989000000059605 ],
							[ 370350.548000000009779, 5679652.145999999716878 ],
							[ 370347.877999998978339, 5679660.156999999657273 ],
							[ 370342.678999998024665, 5679675.896999999880791 ],
							[ 370339.817000002018176, 5679684.583999999798834 ],
							[ 370317.120999998995103, 5679678.536000000312924 ],
							[ 370299.640999999013729, 5679670.399000000208616 ],
							[ 370292.184000000008382, 5679666.927000000141561 ],
							[ 370273.350000001024455, 5679658.160000000149012 ],
							[ 370268.476999997976236, 5679668.626000000163913 ],
							[ 370258.489000000001397, 5679690.254999999888241 ],
							[ 370280.326999999990221, 5679700.400999999605119 ],
							[ 370300.296999997983221, 5679708.610000000335276 ],
							[ 370305.365000002027955, 5679710.69400000013411 ],
							[ 370308.160999997984618, 5679705.037999999709427 ],
							[ 370309.46999999898253, 5679705.622999999672174 ],
							[ 370331.155999999027699, 5679715.485000000335276 ],
							[ 370332.760999999998603, 5679711.252999999560416 ],
							[ 370333.543999999994412, 5679709.429999999701977 ],
							[ 370335.032999999995809, 5679705.768000000156462 ]
						]
					]
				]
			},
			crs: { type: 'name', properties: { name: 'urn:ogc:def:crs:EPSG::25832' } },
			properties: {
				id: 10198,
				name: 'Elberfeld 335 48/0',
				kurzname: 'Elberfeld 335 48/0'
			}
		}
	];
	let windowSize = useWindowSize();
	const zoom = 13.5;
	const layers = 'wupp-plan-live@90';
	const namedMapStyle = 'default';

	return (
		<div>
			<Map
				crs={MappingConstants.crs25832}
				style={{
					height:
						predefinedHeight != null && predefinedHeight > 150
							? predefinedHeight
							: windowSize.innerHeight - 630
				}}
				center={{
					lat: 51.252933,
					lng: 7.141941
				}}
				zoomControl={true}
				attributionControl={false}
				dragging={true}
				keyboard={false}
				zoom={zoom}
				minZoom={5}
				maxZoom={16}
				zoomSnap={0.5}
				zoomDelta={0.5}
			>
				{getLayersByName(layers, namedMapStyle)}
				<FeatureCollectionDisplay
					// key={
					// 	'FeatureCollectionDisplayPreview.' +
					// 	currentMarkerSize +
					// 	'clustered:' +
					// 	clusteredMarkers +
					// 	'.customPostfix:' +
					// 	featureCollectionKeyPostfix
					// }
					featureCollection={mockFC}
					showMarkerCollection={false}
					style={(feature) => {
						const radius = 1; //not used
						const fillColor = new Color('green');
						const color = fillColor.darken(0.5);
						const svg = undefined;
						const svgSize = undefined;
						const style = {
							radius,
							fillColor,
							color,
							opacity: 1,
							fillOpacity: 0.8,
							svg,
							svgSize
						};
						return style;
					}}
				/>
			</Map>
		</div>
	);
};

export default LagisMap;
